# MARUNI Phase 3 실행 계획

**작성일**: 2025-10-12
**버전**: 1.0.0
**상태**: 계획 수립 완료
**목표**: 새로운 유저 흐름 설계 반영 및 핵심 기능 구현

---

## 📋 목차

1. [개요](#개요)
2. [현재 상태](#현재-상태)
3. [Phase별 실행 계획](#phase별-실행-계획)
4. [Phase 간 의존성](#phase-간-의존성)
5. [전체 타임라인](#전체-타임라인)
6. [성공 기준](#성공-기준)

---

## 개요

### 목적

MARUNI 클라이언트를 새로운 유저 흐름 설계(user-flow.md, USER_FLOW_DESIGN.md)에 맞춰 재구성하고, 핵심 기능을 단계적으로 구현합니다.

### 설계 원칙

- **단일 앱 구조**: 노인/보호자 모두 하나의 앱 사용
- **역할별 동적 화면**: 사용자 역할에 따라 메인 화면이 동적으로 구성됨
- **단계적 구현**: 의존성 고려한 Phase별 개발
- **지속적 테스트**: 각 Phase 완료 시 통합 테스트

### 참조 문서

- [user-flow.md](./flows/user-flow.md) - 새로운 사용자 여정 (2025-01-06)
- [USER_FLOW_DESIGN.md](./architecture/USER_FLOW_DESIGN.md) - 역할별 플로우 설계 (2025-10-12)
- [설계-구현 차이점 분석 보고서](#) - 현재 구현 상태 분석 (2025-10-12)

---

## 현재 상태

### 구현 완료 (Phase 1-2)

| 항목 | 상태 | 비고 |
|------|------|------|
| 기본 UI 컴포넌트 | ✅ 100% | Button, Input, Card, Layout 등 6개 |
| 인증 기능 | ✅ 80% | 로그인, JWT 토큰 관리 |
| 라우팅 기본 구조 | ⚠️ 30% | /login, /dashboard만 구현 |
| 개발 환경 설정 | ✅ 100% | Vite, TypeScript, Tailwind v4 |

### 미구현 (Phase 3 목표)

| 항목 | 현재 상태 | 목표 |
|------|----------|------|
| 역할별 동적 메인 화면 | ❌ 0% | ✅ 100% |
| 회원가입 + 온보딩 | ❌ 0% | ✅ 100% |
| 보호자 관리 | ❌ 0% | ✅ 100% |
| AI 대화 | ❌ 0% | ✅ 100% |
| 설정 관리 | ❌ 0% | ✅ 80% |
| 알림 기능 | ❌ 0% | ⏳ 50% |

---

## Phase별 실행 계획

### Phase 3-1: 기반 확립 (Foundation)

**목표**: 역할별 동적 화면 구성을 위한 데이터 구조 및 메인 화면 완성

**핵심 작업**:
1. User 데이터 모델 확장
   - dailyCheckEnabled, guardian, managedMembers 필드 추가
   - Guardian, ManagedMember 타입 정의

2. 메인 화면 역할별 동적 구성
   - "내 안부 메시지" 섹션 (dailyCheckEnabled 기반)
   - "내 보호자" 섹션 (guardian 기반)
   - "내가 돌보는 사람들" 섹션 (managedMembers 기반)
   - "시작 가이드" 섹션 (모두 없을 때)

3. 비즈니스 컴포넌트 추가
   - MessageCard (안부 메시지 카드)
   - GuardianCard (보호자 정보 카드)
   - ManagedMemberCard (보호 대상 카드)

**완성 기준**:
- ✅ 메인 화면이 사용자 역할에 따라 다르게 표시됨
- ✅ 3가지 페르소나 (김순자, 김영희, 박철수) 화면 차별화
- ✅ API 응답 기반 동적 렌더링 작동

**예상 소요 시간**: 1-2일 (6-8시간)

**우선순위**: 🔴 긴급 (다른 모든 Phase의 기반)

---

### Phase 3-2: 회원 온보딩 (Onboarding)

**목표**: 새로운 사용자가 가입하고 서비스를 시작할 수 있는 완전한 플로우 구현

**핵심 작업**:
1. 회원가입 기능
   - 회원가입 페이지 (/register)
   - 이메일 중복 확인
   - 회원가입 API 연동 (POST /api/join)

2. 온보딩 플로우 (3단계)
   - 온보딩 페이지 (/onboarding)
   - Step 1: 서비스 소개
   - Step 2: AI 대화 설명
   - Step 3: 보호자 등록 안내
   - [나중에 하기] / [보호자 등록] 선택 처리

3. 라우팅 확장
   - /register 라우트 추가
   - /onboarding 라우트 추가
   - 회원가입 후 온보딩 자동 연결

**완성 기준**:
- ✅ 사용자가 앱을 처음 열고 회원가입 완료 가능
- ✅ 온보딩 3단계 완료 후 메인 화면 진입
- ✅ user-flow.md Journey 1 (첫 시작) 재현 가능

**예상 소요 시간**: 1-2일 (6-8시간)

**우선순위**: 🟠 높음

---

### Phase 3-3: 보호자 관계 (Guardian)

**목표**: 노인과 보호자 간 관계 성립 및 관리 기능 완성

**핵심 작업**:
1. features/guardian 모듈 생성
   - API: 보호자 검색, 등록 요청, 수락, 거절
   - Hooks: useGuardian, useManagedMembers
   - Types: Guardian, GuardianRequest, ManagedMember

2. 보호자 관리 화면
   - 보호자 관리 페이지 (/guardians)
   - 보호자 찾기 화면 (/guardians/search)
   - 보호자 요청 목록 (/guardians/requests)

3. 보호자 관계 플로우
   - 노인: 보호자 검색 → 등록 요청
   - 보호자: 요청 수신 → 수락/거절
   - 관계 성립 시 메인 화면 자동 업데이트

**완성 기준**:
- ✅ 김순자가 김영희를 보호자로 검색 및 요청 가능
- ✅ 김영희가 요청 수락 후 "내가 돌보는 사람들" 섹션 표시
- ✅ user-flow.md Journey 3-4 (보호자 등록, 보호자 알림) 재현 가능

**예상 소요 시간**: 2-3일 (10-12시간)

**우선순위**: 🟠 높음

---

### Phase 3-4: AI 대화 (Conversation)

**목표**: 노인이 AI와 자연스러운 대화를 나누는 핵심 기능 구현

**핵심 작업**:
1. features/conversation 모듈 생성
   - API: 메시지 전송, 대화 이력 조회
   - Hooks: useConversation, useMessageSend
   - Types: Message, Conversation, EmotionStatus

2. 대화 화면
   - 대화 페이지 (/conversation)
   - ChatMessage 컴포넌트 (사용자/AI 메시지 구분)
   - MessageInput 컴포넌트 (텍스트 입력)
   - 대화 이력 표시

3. AI 대화 기능
   - 메시지 전송 및 AI 응답 수신
   - 감정 분석 결과 표시 (POSITIVE/NEGATIVE/NEUTRAL)
   - 대화 이력 저장 및 조회

**완성 기준**:
- ✅ 노인이 AI와 실시간 대화 가능
- ✅ AI 응답이 자연스럽게 표시됨
- ✅ user-flow.md Journey 2 (첫 안부 메시지 받기) 재현 가능

**예상 소요 시간**: 2일 (8-10시간)

**우선순위**: 🟠 높음

---

### Phase 3-5: 설정 관리 (Settings)

**목표**: 사용자가 앱 설정 및 개인정보를 관리할 수 있는 기능 구현

**핵심 작업**:
1. features/member 모듈 확장
   - API: 내 정보 수정, 비밀번호 변경
   - Hooks: useProfile, useSettings
   - Types: ProfileUpdateRequest, SettingsData

2. 설정 화면
   - 설정 메뉴 페이지 (/settings)
   - 내 정보 수정 페이지 (/settings/profile)
   - 알림 설정 페이지 (/settings/notifications)
   - 안부 메시지 ON/OFF 설정

3. 설정 기능
   - 이름, 전화번호 수정
   - 비밀번호 변경
   - dailyCheckEnabled 토글
   - 알림 수신 설정

**완성 기준**:
- ✅ 설정 메뉴에서 모든 항목 접근 가능
- ✅ 내 정보 수정 후 즉시 반영
- ✅ 안부 메시지 ON/OFF 시 메인 화면 섹션 변화

**예상 소요 시간**: 1-2일 (6-8시간)

**우선순위**: 🟡 중간

---

### Phase 3-6: 알림 기능 (Notification)

**목표**: 이상 징후 알림 및 푸시 알림 기본 기능 구현

**핵심 작업**:
1. features/notification 모듈 생성
   - API: 알림 목록, 알림 상세, 알림 읽음 처리
   - Hooks: useNotifications, useAlerts
   - Types: Notification, Alert, AlertLevel

2. 알림 화면
   - 알림 목록 페이지 (/alerts)
   - 알림 상세 페이지 (/alerts/:id)
   - AlertCard 컴포넌트

3. 알림 기능 (기본)
   - 알림 목록 조회 및 표시
   - 알림 읽음 처리
   - 알림 배지 표시 (미읽음 개수)

**완성 기준**:
- ✅ 알림 목록에서 모든 알림 확인 가능
- ✅ 알림 상세에서 대화 내용 확인 가능
- ✅ 미읽음 알림 배지 표시

**예상 소요 시간**: 1-2일 (6-8시간)

**우선순위**: 🟡 중간

**참고**: FCM 푸시 알림 연동은 Phase 4로 연기

---

### Phase 3-7: 공통 기능 보완 (Polish)

**목표**: 사용자 경험 개선 및 누락된 공통 기능 추가

**핵심 작업**:
1. 하단 네비게이션 바
   - NavigationBar 컴포넌트
   - [홈] [대화] [설정] [알림] 탭
   - 현재 페이지 하이라이트

2. 공통 컴포넌트 보완
   - Toast 알림 (성공/에러 메시지)
   - Modal 컴포넌트
   - EmptyState 컴포넌트

3. 에러 처리 개선
   - 네트워크 에러 처리
   - API 에러 메시지 표시
   - 재시도 버튼

**완성 기준**:
- ✅ 모든 화면에서 하단 네비게이션 바 표시
- ✅ Toast로 성공/에러 메시지 통일
- ✅ 네트워크 에러 시 명확한 안내

**예상 소요 시간**: 1일 (4-6시간)

**우선순위**: 🟢 낮음

---

## Phase 간 의존성

```
Phase 3-1 (기반 확립)
    │
    ├──→ Phase 3-2 (회원 온보딩)
    │       ↓
    │   Phase 3-3 (보호자 관계)
    │       ↓
    ├──→ Phase 3-4 (AI 대화)
    │
    └──→ Phase 3-5 (설정 관리)
            │
            └──→ Phase 3-6 (알림 기능)
                    │
                    └──→ Phase 3-7 (공통 기능 보완)
```

**의존성 규칙**:
- Phase 3-1은 모든 Phase의 **필수 전제조건**
- Phase 3-2, 3-3, 3-4는 Phase 3-1 완료 후 **병렬 진행 가능**
- Phase 3-5, 3-6은 Phase 3-3 완료 후 진행 권장
- Phase 3-7은 모든 Phase 완료 후 진행

---

## 전체 타임라인

### 2주 집중 개발 (핵심 기능)

| Week | Day | Phase | 작업 내용 | 누적 진행률 |
|------|-----|-------|----------|------------|
| 1주차 | 1일 | 3-1 | User 모델 확장 + 메인 화면 동적 구성 | 15% |
| 1주차 | 2일 | 3-1 | 비즈니스 컴포넌트 추가 + 테스트 | 25% |
| 1주차 | 3일 | 3-2 | 회원가입 + 이메일 중복 확인 | 35% |
| 1주차 | 4일 | 3-2 | 온보딩 3단계 + 라우팅 | 45% |
| 1주차 | 5일 | 3-3 | 보호자 검색 + 등록 요청 | 55% |
| 2주차 | 6일 | 3-3 | 보호자 요청 수락 + 통합 테스트 | 65% |
| 2주차 | 7일 | 3-4 | AI 대화 화면 + 메시지 전송 | 75% |
| 2주차 | 8일 | 3-4 | 대화 이력 + 감정 분석 표시 | 85% |
| 2주차 | 9일 | 3-5 | 설정 화면 + 내 정보 수정 | 90% |
| 2주차 | 10일 | 3-6 | 알림 목록 + 알림 상세 | 95% |

### 추가 개발 (보완 기능)

| Week | Day | Phase | 작업 내용 | 누적 진행률 |
|------|-----|-------|----------|------------|
| 3주차 | 11-12일 | 3-7 | 네비게이션 바 + 공통 컴포넌트 | 100% |

**총 예상 기간**: 2-3주 (10-12 근무일)

---

## 성공 기준

### Phase 3 완료 시 달성 상태

#### 기능 완성도
- ✅ **회원가입 + 온보딩**: 새 사용자가 처음부터 가입 가능
- ✅ **역할별 메인 화면**: 김순자, 김영희, 박철수 각자 다른 화면
- ✅ **AI 대화**: 노인이 AI와 실시간 대화 가능
- ✅ **보호자 관계**: 노인 ↔ 보호자 관계 성립 및 관리
- ✅ **설정 관리**: 내 정보 수정, 안부 메시지 ON/OFF
- ✅ **알림 기능**: 알림 목록 조회 및 상세 확인

#### 사용자 여정 재현
- ✅ **Journey 1** (첫 시작): 회원가입 → 온보딩 → 메인 화면
- ✅ **Journey 2** (안부 메시지): 푸시 알림 → AI 대화
- ✅ **Journey 3** (보호자 등록): 검색 → 요청 → 수락
- ✅ **Journey 4** (보호자 알림): 이상 징후 감지 → 알림 수신

#### 기술 지표
- ✅ **코드 커버리지**: 핵심 기능 80% 이상
- ✅ **TypeScript 에러**: 0건
- ✅ **ESLint 경고**: 중요 경고 0건
- ✅ **빌드 성공**: npm run build 성공

#### 사용성
- ✅ **노인 친화적**: 터치 영역 60px+, 폰트 20px+
- ✅ **접근성**: WCAG 2.1 AA 기준 충족
- ✅ **반응 속도**: API 응답 2초 이내
- ✅ **에러 처리**: 모든 에러에 명확한 안내

---

## 다음 단계

### Phase 3 완료 후 (Phase 4 계획)

**Phase 4에서 추가할 기능**:
- FCM 푸시 알림 연동
- 이상 징후 자동 감지 (3일 연속 NEGATIVE 등)
- 무응답 감지 (24시간 무응답)
- 오프라인 대화 저장 및 동기화
- 성능 최적화 (React.memo, useMemo)
- PWA 오프라인 지원 강화

**Phase 4 시작 조건**:
- ✅ Phase 3-1 ~ 3-6 모두 완료
- ✅ 주요 버그 수정 완료
- ✅ 통합 테스트 통과

---

## 부록

### 세부 계획 작성 규칙

각 Phase 시작 시 다음 형식으로 세부 계획을 작성합니다:

1. **Phase 개요**: 목표, 범위, 제약사항
2. **작업 분해**: Task 단위로 세분화 (1-2시간 단위)
3. **구현 가이드**: 파일 구조, 코드 예시, API 명세
4. **테스트 계획**: 단위 테스트, 통합 테스트 시나리오
5. **완료 체크리스트**: 기능, 코드 품질, 문서화

### 문서 위치

- **큰 틀 계획**: `docs/PHASE3_EXECUTION_PLAN.md` (본 문서)
- **세부 계획**: `docs/phases/phase3-{N}-{name}.md`
  - 예: `docs/phases/phase3-1-foundation.md`
  - 예: `docs/phases/phase3-3-guardian.md`

---

**📅 문서 작성일**: 2025-10-12
**✏️ 작성자**: Claude Code
**🔄 버전**: 1.0.0
**📍 다음 단계**: Phase 3-1 세부 계획 작성 및 구현 시작
