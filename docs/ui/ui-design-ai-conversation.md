# MARUNI AI 대화 페이지 UI 설계

**마루니와 대화하기** - OpenAI GPT-4o 기반 AI 어시스턴트와의 자연스러운 대화

## 🎯 페이지 목적 및 사용자 플로우

### **기능 개요**
- OpenAI GPT-4o 기반 AI "마루니"와의 실시간 대화
- 텍스트 및 음성 입력 지원
- 감정 분석을 통한 이상징후 감지
- 대화 세션 자동 저장 및 이력 관리

### **사용자 여정**
```
🏠 메인 대시보드 → 🤖 마루니와 대화하기 터치
    ↓
💬 기존 대화 이어하기 OR 새 대화 시작
    ↓
💭 메시지 입력 (텍스트/음성)
    ↓
📤 전송 → 🤖 AI 응답 대기 (타이핑 애니메이션)
    ↓
💬 응답 표시 → 🔄 대화 계속
    ↓
🏠 언제든 메인으로 돌아가기
```

## 📱 페이지 레이아웃 설계

### **전체 화면 구성 (채팅 스타일)**
```
┌─────────────────────────────────────┐
│ ← 뒤로   🤖 마루니와 대화    ⋮ 메뉴  │ ← 헤더 (60px)
├─────────────────────────────────────┤
│                                     │
│                                     │
│                                     │
│          대화 메시지 영역            │ ← 대화 영역 (가변)
│                                     │
│                                     │
│                                     │
├─────────────────────────────────────┤
│ [입력창]              🎤  📤        │ ← 입력 바 (80px)
└─────────────────────────────────────┘
```

## 📋 구역별 상세 설계

### **1. 헤더 영역 (60px)**
```tsx
// 디자인 명세
높이: 60px
배경: 흰색 (#ffffff)
테두리: 하단 연한 회색 라인
그림자: 미묘한 그림자 효과

// 왼쪽: 뒤로가기
← 뒤로 (24px 아이콘)
터치 영역: 48px × 48px
터치 시: 메인 대시보드로 이동

// 중앙: AI 정보
🤖 마루니와 대화
폰트: 20px, 굵게, 검정색
아래 작은 텍스트: "AI 어시스턴트" (14px, 회색)

// 오른쪽: 메뉴
⋮ 메뉴 (24px 아이콘)
터치 영역: 48px × 48px
터치 시: 드롭다운 메뉴 (대화 삭제, 새 대화 등)
```

### **2. 대화 메시지 영역 (가변 높이)**
```tsx
// 디자인 명세
높이: 화면 높이 - 헤더(60px) - 입력바(80px)
배경: 연한 회색 (#f9fafb)
패딩: 16px
스크롤: 자동, 새 메시지 시 하단으로 스크롤

// 메시지 없을 때 (첫 대화)
환영 메시지 표시 (중앙 정렬)
```

#### **환영 메시지 (대화 시작 전)**
```tsx
// 중앙 정렬 환영 화면
🤖 [큰 마루니 아바타] (80px)
   원형, 따뜻한 색상 배경

"안녕하세요! 저는 마루니예요"
폰트: 24px, 굵게, 검정색

"궁금한 것이 있으면 언제든 물어보세요
건강, 날씨, 일상 대화 모두 좋아요!"
폰트: 16px, 보통, 회색
중앙 정렬, 줄간격 1.5

// 대화 시작 도움말
💡 "오늘 날씨가 어때요?" 같은 질문으로 시작해보세요
폰트: 14px, 이탤릭, 연한 회색
```

#### **사용자 메시지 (오른쪽 정렬)**
```tsx
// 디자인 명세
정렬: 오른쪽
최대 너비: 80%
여백: 왼쪽 20%, 오른쪽 0
위아래 간격: 8px

// 메시지 버블
배경: 주요 파란색 (#2563eb)
텍스트: 흰색
패딩: 12px 16px
모서리: 둥근 모서리 16px (오른쪽 하단만 4px)
폰트: 16px, 보통

// 시간 표시
"오후 2:35"
폰트: 12px, 회색
위치: 메시지 아래 오른쪽
```

#### **AI 메시지 (왼쪽 정렬)**
```tsx
// 디자인 명세
정렬: 왼쪽
최대 너비: 80%
여백: 왼쪽 0, 오른쪽 20%
위아래 간격: 8px

// 아바타 + 메시지 조합
🤖 [작은 아바타] (32px) + [메시지 버블]
   아바타: 왼쪽 고정
   메시지: 아바타 옆 8px 간격

// 메시지 버블
배경: 흰색 (#ffffff)
텍스트: 검정색 (#1f2937)
테두리: 연한 회색 1px
패딩: 12px 16px
모서리: 둥근 모서리 16px (왼쪽 하단만 4px)
폰트: 16px, 보통
그림자: 미묘한 그림자

// 시간 표시
"오후 2:36"
폰트: 12px, 회색
위치: 메시지 아래 왼쪽
```

#### **타이핑 인디케이터 (AI 응답 중)**
```tsx
// AI가 응답을 생성 중일 때
🤖 [아바타] + [타이핑 버블]

// 타이핑 버블
배경: 흰색
3개 점 애니메이션: ● ● ●
패딩: 12px 16px
모서리: 둥근 모서리 16px

// 애니메이션
점들이 순차적으로 커졌다 작아짐
지속 시간: 1.5초 반복
```

### **3. 하단 입력 바 (80px)**
```tsx
// 디자인 명세
높이: 80px
배경: 흰색 (#ffffff)
테두리: 상단 연한 회색 라인
패딩: 16px
그림자: 상단 미묘한 그림자

// 레이아웃: 입력창 + 음성버튼 + 전송버튼
[        입력창        ] [🎤] [📤]
     (가변 너비)      40px  40px
```

#### **메시지 입력창**
```tsx
// 디자인 명세
높이: 48px
너비: 가변 (전체 - 음성버튼 - 전송버튼 - 간격)
배경: 연한 회색 (#f3f4f6)
테두리: 없음
모서리: 둥근 모서리 24px
패딩: 12px 16px
폰트: 16px, 보통

// placeholder
"마루니에게 메시지를 보내세요..."
색상: 회색 (#9ca3af)

// 포커스 시
배경: 흰색
테두리: 파란색 2px (#2563eb)
```

#### **음성 입력 버튼**
```tsx
// 기본 상태
🎤 (24px 아이콘)
크기: 48px × 48px 원형
배경: 연한 회색 (#f3f4f6)
아이콘: 회색 (#6b7280)

// 활성 상태 (음성 인식 중)
배경: 빨간색 (#dc2626)
아이콘: 흰색
펄스 애니메이션 효과
```

#### **전송 버튼**
```tsx
// 비활성 상태 (메시지 없을 때)
📤 (24px 아이콘)
크기: 48px × 48px 원형
배경: 연한 회색 (#d1d5db)
아이콘: 회색

// 활성 상태 (메시지 있을 때)
배경: 주요 파란색 (#2563eb)
아이콘: 흰색
터치 시: 살짝 어두워짐
```

## 🔄 상태별 화면 변화

### **1. 첫 방문 (대화 없음)**
```
- 환영 메시지 표시
- 대화 시작 가이드
- 입력창 활성화
```

### **2. 메시지 입력 중**
```
- 입력창 포커스 (흰색 배경, 파란 테두리)
- 전송 버튼 활성화 (파란색)
- 키보드 올라와도 레이아웃 유지
```

### **3. 음성 입력 모드**
```
- 음성 버튼 빨간색 + 펄스 애니메이션
- "말씀하고 계신 내용을 듣고 있어요" 팝업
- 다른 버튼들 비활성화
```

### **4. 메시지 전송 후**
```
- 사용자 메시지 즉시 표시 (오른쪽)
- 입력창 초기화
- 타이핑 인디케이터 표시 (AI 응답 대기)
```

### **5. AI 응답 수신**
```
- 타이핑 인디케이터 제거
- AI 메시지 타이핑 애니메이션으로 표시
- 자동 스크롤 (최신 메시지로)
```

### **6. 대화 중 (기존 메시지들)**
```
- 스크롤 가능한 메시지 리스트
- 날짜별 구분선 (어제, 오늘 등)
- 읽지 않은 메시지 표시 (선택적)
```

## 🎨 색상 및 스타일 가이드

### **메시지 색상 시스템**
```css
/* 사용자 메시지 */
--user-message-bg: #2563eb;
--user-message-text: #ffffff;

/* AI 메시지 */
--ai-message-bg: #ffffff;
--ai-message-text: #1f2937;
--ai-message-border: #e5e7eb;

/* 입력 영역 */
--input-bg: #f3f4f6;
--input-focus-bg: #ffffff;
--input-focus-border: #2563eb;

/* 상태 색상 */
--voice-active: #dc2626;
--send-active: #2563eb;
--send-disabled: #d1d5db;
```

### **애니메이션 효과**
```css
/* 타이핑 인디케이터 */
@keyframes typing-dots {
  0%, 60%, 100% { transform: scale(1); opacity: 0.4; }
  30% { transform: scale(1.2); opacity: 1; }
}

.typing-dot:nth-child(1) { animation-delay: 0s; }
.typing-dot:nth-child(2) { animation-delay: 0.2s; }
.typing-dot:nth-child(3) { animation-delay: 0.4s; }

/* 메시지 등장 애니메이션 */
@keyframes message-appear {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* 음성 버튼 펄스 */
@keyframes voice-pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}
```

## 🤖 AI 응답 특별 기능

### **감정 분석 표시 (선택적)**
```tsx
// AI 메시지 하단에 미묘하게 표시
😊 긍정적    😐 보통    😔 우려됨
작은 아이콘으로 감정 상태 표시
보호자 알림 연동
```

### **추천 질문 (대화 시작 도움)**
```tsx
// 환영 메시지 하단에 표시
"이런 질문은 어떠세요?"

💭 "오늘 날씨가 어떤가요?"
💭 "건강 관리 팁을 알려주세요"
💭 "재미있는 이야기 들려주세요"

각 30px 높이, 터치 시 자동 입력
```

### **응급 상황 감지**
```tsx
// 특정 키워드 감지 시
🚨 "도움이 필요하시나요?"
   "보호자에게 연락할까요?"

[예, 연락해주세요] [아니오, 괜찮아요]
```

## 🧪 접근성 및 사용성

### **노인 친화적 고려사항**
```tsx
// 큰 텍스트 및 터치 영역
.message-text { font-size: 16px; line-height: 1.5; }
.touch-button { min-width: 48px; min-height: 48px; }

// 명확한 대화 구분
.user-message { text-align: right; }
.ai-message { text-align: left; }

// 쉬운 스크롤
.message-list {
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
}
```

### **음성 기능 최적화**
```tsx
// Web Speech API 설정
const recognition = new webkitSpeechRecognition();
recognition.lang = 'ko-KR';
recognition.continuous = false;
recognition.interimResults = false;

// 음성 인식 실패 시
"음성을 인식하지 못했어요. 다시 말씀해 주세요"
자동으로 텍스트 입력 모드로 전환
```

### **오프라인 대응**
```tsx
// 네트워크 오류 시
"인터넷 연결을 확인해 주세요"
"메시지가 전송되지 않았습니다"

// 임시 저장
localStorage에 입력 중인 메시지 저장
앱 재실행 시 복구 제안
```

## 📱 반응형 및 성능 고려

### **메시지 가상화**
```tsx
// 긴 대화 시 성능 최적화
react-window 또는 react-virtualized 사용
화면에 보이는 메시지만 렌더링
스크롤 시 동적 로딩
```

### **이미지 최적화**
```tsx
// 아바타 이미지
WebP 포맷 사용
다양한 크기 제공 (32px, 80px)
지연 로딩 적용
```

## 🚀 구현 우선순위

### **Phase 1: 기본 채팅**
1. 메시지 송수신 기본 구조
2. 사용자/AI 메시지 구분 표시
3. 입력창 및 전송 기능

### **Phase 2: 고급 기능**
1. 타이핑 인디케이터
2. 음성 입력 (Web Speech API)
3. 메시지 애니메이션

### **Phase 3: 최적화**
1. 가상화를 통한 성능 최적화
2. 오프라인 지원
3. 접근성 개선

---

**🤖 이 AI 대화 페이지는 노인분들이 마루니와 자연스럽고 편안하게 대화할 수 있도록 설계되었습니다!**